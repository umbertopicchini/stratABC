% PURPOSE: demo of seasBB()
%          Time series bootstap: overlapping blocks for seasonal factors
%---------------------------------------------------
% USAGE: seasBB_d
%---------------------------------------------------

clc; clear all; close all;
% Seasonal component extracted from Los Angeles Ozone data
% 1955.1 - 1972.12
% Using Tramo-Seats TSW (rsa=4) 
% Rows are years and columns are months
% Box, G. E. P., and Tiao, G. C. (1975), "Intervention Analysis With 
% Applications to Environmental and Economic Problems," Journal of the 
% American Statistical Association, 70, 70-79.

X=[  60.6277   59.3649   77.5334   95.8562  100.9873  114.9680  121.0555  115.6694  133.9815  116.8842  108.1969   81.0364
   61.0491   61.0319   86.7642   85.9016   98.8991  114.9088  121.7876  117.6109  134.4212  115.2655  105.1679   81.2150
   60.9009   61.8127   77.6994   96.5812   97.7662  116.0395  123.4092  120.2174  133.9285  115.0679  101.6529   80.1353
   60.4724   61.9741   76.9382   98.9346   98.0566  118.2688  125.6332  122.2911  131.9011  115.6996   97.7349   77.1796
   59.1400   61.9908   87.6931   89.6878   98.9464  120.9321  129.7044  126.2096  131.3278  117.1262   93.4368   73.2147
   57.7115   62.6513   76.9899  103.5569   99.9200  121.3931  131.9391  130.2816  131.7906  118.4205   88.7065   70.0710
   57.6486   64.6543   83.2453   96.0165  100.2775  120.2227  133.3613  133.9169  131.8238  120.4122   85.4105   67.6385
   57.1132   66.4337   76.1876  104.9782  101.1864  118.7383  134.9682  137.5554  132.5955  122.4605   83.1645   64.9937
   55.9184   68.0747   76.7313  104.0473  102.7067  118.9059  137.6053  140.2204  133.0715  123.6411   81.0982   61.5597
   55.0856   68.7003   88.1657   91.4668  104.9132  119.7087  139.6091  142.2728  133.0308  125.4723   79.9225   57.8936
   54.8727   68.8756   79.0611  103.8179  106.8543  119.7111  139.9426  143.6981  132.8332  126.8027   80.1989   55.8065
   54.6580   68.4436   80.2612  102.7479  108.8199  119.8278  140.9410  145.0296  132.7366  125.7049   79.7235   54.7721
   55.2143   68.9782   91.9239   89.0747  110.5569  118.4105  140.9974  145.8025  131.8500  122.5690   79.4157   54.7516
   55.8974   69.3573   82.5470  102.5517  112.8000  117.1078  140.0070  146.7502  131.2646  117.3207   77.9092   54.9264
   55.9403   69.3577   84.1219  105.4672  115.1578  117.3221  139.3561  148.2272  130.7368  112.2192   75.3859   54.5694
   55.9511   70.2563   97.5427   95.5469  116.1770  118.5668  139.7604  148.8712  130.0316  108.4544   72.7002   53.4053
   56.4524   71.4290   87.7721  110.6594  116.7476  120.5349  141.1140  148.1519  127.9470  105.1202   71.1963   52.5557
   56.6109   71.9839   97.3331  103.0438  118.1589  121.8538  142.4837  148.6268  127.1799  102.9775   70.4268   52.2091 ];

% Transforming X in vector form
x = vec(X');

% Seasonal frequency
s = 12;

% Block size
b = 4;

% Number of bootstrap replications
J = 1000;

% Resampling using Politis seasonal block bootstrap
xb=[];
for j=1:J
   xb = [xb seasBB(x,s,b)];
end

% Plot
plot([median(xb') ; median(xb')-2*std(xb')  ; median(xb')+2*std(xb')]')
title('Los Angeles Ozone data: seasonal factors: mean and +/- 2sigma');
